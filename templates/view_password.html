{% extends "base.html" %}
{% block content %}
<div class="view-container">
    <h2>ðŸ”’ Saved Passwords</h2>
    <p class="sub-text">You can view, edit, delete, or copy your passwords here.</p>

    <!-- Search Bar -->
    <input type="text" id="search" placeholder="Search website..." onkeyup="filterTable()">

    <!-- Password Table -->
    <table id="passwordTable">
        <tr>
            <th>Website</th>
            <th>Password</th>
            <th>Actions</th>
        </tr>
        {% for pw in passwords %}
        <tr>
            <td>{{ pw.site }}</td>
            <td>{{ pw.password }}</td>
            <td>
                <a href="{{ url_for('edit_password', site=pw.site) }}" class="btn edit-btn">Edit</a>
                <form action="{{ url_for('delete_password', site=pw.site) }}" method="POST" style="display:inline;">
                    <button type="submit" class="btn delete-btn">Delete</button>
                </form>
                <button onclick="navigator.clipboard.writeText('{{ pw.password }}')" class="btn copy-btn">Copy</button>
            </td>
        </tr>
        {% endfor %}
    </table>

    <p class="back-btn">
        <a href="{{ url_for('dashboard') }}" class="btn btn-primary">Back to Dashboard</a>
    </p>
</div>

<script>
function filterTable() {
    let input = document.getElementById('search').value.toLowerCase();
    let rows = document.querySelectorAll('#passwordTable tr');
    rows.forEach((row, index) => {
        if(index === 0) return; // Skip header
        let site = row.cells[0].textContent.toLowerCase();
        row.style.display = site.includes(input) ? '' : 'none';
    });
}
</script>
{% endblock %}

