{% extends "base.html" %}
{% block content %}
<h2>Dashboard â€” {{ username }}</h2>

{% if note %}
  <p class="error">{{ note }}</p>
{% endif %}

<div class="controls">
  <form method="get" action="{{ url_for('dashboard') }}">
    <input name="q" placeholder="Search site..." value="{{ query }}">
    <button type="submit">Search</button>
  </form>

  <form id="addForm" method="post" action="{{ url_for('add_password') }}">
    <input name="website" placeholder="Website" required>
    <input id="passInput" name="password" placeholder="Password" required>
    <button type="button" id="genBtn">Generate</button>
    <button type="submit">Add</button>
  </form>

  <a href="{{ url_for('export_csv') }}">Export CSV</a>
</div>

<table>
  <thead><tr><th>Site</th><th>Password</th><th>Actions</th></tr></thead>
  <tbody>
  {% for p in passwords %}
    <tr>
      <td>{{ p.site }}</td>
      <td><input class="pwd" value="{{ p.pass }}" readonly></td>
      <td>
        <a href="{{ url_for('edit', site=p.site) }}">Edit</a>
        <form style="display:inline" method="post" action="{{ url_for('delete', site=p.site) }}">
          <button type="submit">Delete</button>
        </form>
        <button class="copyBtn">Copy</button>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>

{% endblock %}
