{% extends "base.html" %}
{% block content %}
<div class="card">
    <h3 class="text-center">ðŸ”’ Saved Passwords</h3>
    <form action="{{ url_for('add_password') }}" method="POST">
        <input type="text" name="website" placeholder="Website" required>
        <input type="text" name="password" placeholder="Password" id="password" required>
        <button type="button" onclick="document.getElementById('password').value='{{ generate_password() }}'">Generate</button>
        <button type="submit">Add</button>
    </form>

    <input type="text" id="search" placeholder="Search website..." onkeyup="filterTable()">

    <table>
        <tr><th>Website</th><th>Password</th><th>Actions</th></tr>
        {% for pw in passwords %}
        <tr>
            <td>{{ pw.site }}</td>
            <td>{{ pw.password }}</td>
            <td>
                <a class="btn edit-btn" href="{{ url_for('edit_password', site=pw.site) }}">Edit</a>
                <form action="{{ url_for('delete_password', site=pw.site) }}" method="POST" style="display:inline;">
                    <button class="btn delete-btn" type="submit">Delete</button>
                </form>
                <button class="btn copy-btn" onclick="navigator.clipboard.writeText('{{ pw.password }}')">Copy</button>
            </td>
        </tr>
        {% endfor %}
    </table>
</div>

<script>
function filterTable() {
    let input = document.getElementById('search').value.toLowerCase();
    let rows = document.querySelectorAll('table tr');
    rows.forEach((row,index)=>{
        if(index===0) return;
        let site=row.cells[0].textContent.toLowerCase();
        row.style.display = site.includes(input)?'':'none';
    });
}
</script>
{% endblock %}
